#!/bin/sh

# 确保只在首次启动运行
[ -f /etc/config/eth_lan_setup ] && exit 0

# 获取所有eth接口（排除eth0和已配置的eth1）
ETH_INTERFACES=$(ls /sys/class/net | grep -E '^eth[0-9]+$' | grep -v '^eth0$' | grep -v '^eth1$')

# 将接口添加到LAN的桥接
for eth in $ETH_INTERFACES; do
    uci add_list network.lan.ifname="$eth"
done

uci commit network

# 标记已执行
touch /etc/config/eth_lan_setup

exit 0
